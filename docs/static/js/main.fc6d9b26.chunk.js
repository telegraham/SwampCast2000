(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{136:function(e,t,a){e.exports=a(257)},141:function(e,t,a){},257:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),r=a(126),o=a.n(r),s=(a(141),a(22)),c=a(23),l=a(25),u=a(24),m=a(26),p=a(274),h=a(258),d="https://tempapi-backend.herokuapp.com";var f=a(135),v=a(58),k=a(48),y=a(269),O=a(268),g=a(276),E=a(266),b=a(270),w={axisLabel:{fontFamily:"Times New Roman"},tickLabels:{fontFamily:"Times New Roman"}},_=Object(k.a)({},w,{tickLabels:Object(k.a)({},w.tickLabels,{fill:"#c50"})}),j=Object(k.a)({},w,{tickLabels:Object(k.a)({},w.tickLabels,{fill:"#0a7"})}),x=function(e){return e+"%"},T=function(e){return e+"\xb0"},D=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).tickValues=function(e){var t=(new Date).getTime();return e.map(function(e){return t-60*e*1e3})},a.putDataInHoverCallback=function(e){return function(t){a.props[e](t)}},a.sizeFn=function(e,t){return t?4:2},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement(y.a,{containerComponent:i.a.createElement(O.a,{voronoiDimension:"x",onActivated:this.putDataInHoverCallback("mouseOver"),onDeactivated:this.putDataInHoverCallback("mouseOut")}),height:390,domain:{x:this.props.range},domainPadding:{y:20}},i.a.createElement(g.a,{label:"Time",scale:"time",tickCount:this.props.tickCount,tickFormat:this.props.xTickFn||this.props.xTick,tickValues:this.props.tickValues?this.tickValues(this.props.tickValues):this.props.tickValues,style:w}),i.a.createElement(g.a,{dependentAxis:!0,tickFormat:T,style:_}),i.a.createElement(g.a,{dependentAxis:!0,tickFormat:x,orientation:"right",style:j}),i.a.createElement(E.a,{x:"time",y:"temperature",interpolation:"linear",data:this.props.data,style:{data:{stroke:"#fc0"}}}),i.a.createElement(b.a,{data:this.props.data,x:"time",y:"temperature",size:this.sizeFn,style:{data:{fill:"#f00"}}}),i.a.createElement(E.a,{x:"time",y:"humidity",interpolation:"linear",data:this.props.data,style:{data:{stroke:"#0ff"}}}),i.a.createElement(b.a,{data:this.props.data,x:"time",y:"humidity",size:this.sizeFn,style:{data:{fill:"#0e5"}}}))}}]),t}(i.a.PureComponent),S=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],C=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"timeOfDay",value:function(e){var t=new Date(e),a=t.getHours(),n=t.getMinutes();return"".concat(a,":").concat(n>9?n:"0"+n)}},{key:"dayOfWeek",value:function(e){return S[new Date(e).getDay()]}},{key:"render",value:function(){return i.a.createElement("ol",{className:"charts"},i.a.createElement("li",null,i.a.createElement(D,{xTick:this.props.xTick,mouseOver:this.props.mouseOver,mouseOut:this.props.mouseOut,data:this.props.last_5_minutes,isUpdate:this.props.isUpdate,tickValues:[5,4,3,2,1,0]})),i.a.createElement("li",null,i.a.createElement(D,{xTick:this.props.xTick,mouseOver:this.props.mouseOver,mouseOut:this.props.mouseOut,data:this.props.last_hour,tickValues:[50,30,10]})),i.a.createElement("li",null,i.a.createElement(D,{xTick:this.props.xTick,mouseOver:this.props.mouseOver,mouseOut:this.props.mouseOut,data:this.props.today,xTickFn:this.timeOfDay})),i.a.createElement("li",null,i.a.createElement(D,{xTick:this.props.xTick,mouseOver:this.props.mouseOver,mouseOut:this.props.mouseOut,data:this.props.last_week,xTickFn:this.dayOfWeek,range:[(new Date).getTime()-6048e5,(new Date).getTime()],tickCount:4})))}}]),t}(i.a.PureComponent),R=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={scrollY:window.pageYOffset},a.handleScroll=function(){a.setState({scrollY:window.pageYOffset})},a.componentDidMount=function(){window.addEventListener("scroll",this.handleScroll)},a.componentWillUnmount=function(){window.removeEventListener("scroll",this.handleScroll)},a.wrapperRef=i.a.createRef(),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"className",value:function(e){var t=["big-number-wrapper"];return this.wrapperRef&&this.wrapperRef.current&&this.state.scrollY>this.wrapperRef.current.offsetTop&&t.push("fixed"),this.props.hover&&t.push("hover"),e.time||t.push("loading"),t.join(" ")}},{key:"render",value:function(){var e=this.props.hover||this.props.latest;return i.a.createElement("div",{ref:this.wrapperRef,className:this.className(e)},e.time?i.a.createElement("dl",{className:"big-number"},i.a.createElement("dt",null,"Temperature"),i.a.createElement("dd",{className:"temperature"},Math.round(e.temperature),"\xb0"),i.a.createElement("dt",null,"Humidity"),i.a.createElement("dd",{className:"humidity"},Math.round(e.humidity),"%"),i.a.createElement("dt",null,"Time"),i.a.createElement("dd",{className:"time"},this.props.xTick(e.time))):"")}}]),t}(i.a.PureComponent),F=a(133),N=a.n(F),L=function(e){return 9*e/5+32},A=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={latest:{},last_5_minutes:[],last_hour:[],today:[],last_week:[]},a.formatDatum=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{humidity:e[t+"humidity"],temperature:L(e[t+"temperature"]),time:new Date(e[a+"time"]).getTime()}},a.handleReceivedReading=function(e){var t=new Date-3e5,n=a.state.last_5_minutes.filter(function(e){return e.time>t}),i=a.formatDatum(e.historical_reading);a.setState({latest:i,last_5_minutes:Object(f.a)(n).concat([i]),isUpdate:!0})},a.xTick=function(e){return new Date-e<5e3?"now":N.a.ago(e,!1)+" ago"},a.mouseOver=function(e){var t=e.find(function(e){return e.temperature&&!e.continuous}),n=e.find(function(e){return e.humidity&&!e.continuous});t&&n&&a.setState({hover:{temperature:t.temperature,humidity:n.humidity,time:t.time}})},a.mouseOut=function(e){a.setState(function(t){return!e[0]||t.hover&&t.hover.time===e[0].time?{hover:null}:{}})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.setReadings()}},{key:"componentDidUpdate",value:function(){this.props.location.slug!==this.state.locationSlug&&this.setReadings()}},{key:"setReadings",value:function(){var e,t,a=this,n=this.props.location.slug;e=n,t=function(e){a.setState({latest:a.formatDatum(e.latest),last_5_minutes:a.data(e.last_5_minutes),last_hour:a.data(e.last_hour,"mean_","start_"),today:a.data(e.today,"mean_","start_"),last_week:a.data(e.last_week,"mean_","start_"),locationSlug:n,isUpdate:!1})},fetch("".concat(d,"/locations/").concat(e,"/readings")).then(function(e){return e.json()}).then(t)}},{key:"data",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e.map(function(e){return t.formatDatum(e,a,n)})}},{key:"render",value:function(){var e=this.props.location;return i.a.createElement("section",null,i.a.createElement("hr",{className:"graph-divider-top"}),i.a.createElement("h2",null,this.props.location.name),i.a.createElement(R,{hover:this.state.hover,latest:this.state.latest,xTick:this.xTick}),i.a.createElement(v.ActionCable,{key:e.slug,channel:{channel:"ReadingsChannel",location:e.slug},onReceived:this.handleReceivedReading}),i.a.createElement(C,{mouseOver:this.mouseOver,mouseOut:this.mouseOut,last_5_minutes:this.state.last_5_minutes,last_hour:this.state.last_hour,today:this.state.today,last_week:this.state.last_week,isUpdate:this.state.isUpdate,xTick:this.xTick}))}}]),t}(n.Component),U=function(e){var t=e.locations.map(function(e){return i.a.createElement("li",{key:e.slug},i.a.createElement(p.a,{to:"/"+e.slug},e.name))});return i.a.createElement("ol",{className:"locations"},t)},V=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("marquee",null,"Welcome to SwampCast 2000!!!"),i.a.createElement("p",null,"Select a location from the menu ^^"))},M=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={locations:[]},a.renderLocation=function(e){var t=e.match.params.locationSlug,n=a.state.locations.find(function(e){return e.slug===t});return n?i.a.createElement(A,{location:n}):i.a.createElement(i.a.Fragment,null)},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;e=function(e){t.setState({locations:e})},fetch("".concat(d,"/locations")).then(function(e){return e.json()}).then(e)}},{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(U,{locations:this.state.locations}),i.a.createElement("h1",{className:"header-main"},i.a.createElement(p.a,{to:"/"},"SwampCast 2000")),i.a.createElement(h.a,{exact:!0,path:"/",component:V}),i.a.createElement(h.a,{path:"/:locationSlug",render:this.renderLocation}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var W=a(273);o.a.render(i.a.createElement(v.ActionCableProvider,{url:"wss://tempapi-backend.herokuapp.com/cable"},i.a.createElement(W.a,null,i.a.createElement(M,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[136,2,1]]]);
//# sourceMappingURL=main.fc6d9b26.chunk.js.map