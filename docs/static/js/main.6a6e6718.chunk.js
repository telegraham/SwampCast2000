(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{136:function(t,e,a){t.exports=a(257)},141:function(t,e,a){},257:function(t,e,a){"use strict";a.r(e);var n=a(1),i=a.n(n),r=a(126),s=a.n(r),o=(a(141),a(22)),l=a(23),u=a(25),c=a(24),m=a(26),h=a(274),p=a(258),d="https://tempapi-backend.herokuapp.com";var f=a(135),v=a(35),y=a(58),k=a(269),g=a(268),O=a(272),w=a(276),E=a(266),b=a(270),j={axisLabel:{fontFamily:"Times New Roman"},tickLabels:{fontFamily:"Times New Roman"}},T=Object(v.a)({},j,{tickLabels:Object(v.a)({},j.tickLabels,{fill:"#c50"})}),_=Object(v.a)({},j,{tickLabels:Object(v.a)({},j.tickLabels,{fill:"#0a7"})}),D=function(t){return t+"%"},x=function(t){return t+"\xb0"},F=function(t){function e(){var t,a;Object(o.a)(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(u.a)(this,(t=Object(c.a)(e)).call.apply(t,[this].concat(i)))).tickValues=function(t){var e=(new Date).getTime();return t.map(function(t){return e-60*t*1e3})},a.putDataInHoverCallback=function(t){return function(e){a.props[t](e,a.props.xTickFnLong||a.props.xTickFn)}},a.sizeFn=function(t,e){return e?4:2},a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return i.a.createElement(k.a,{containerComponent:i.a.createElement(g.a,{voronoiDimension:"x",onActivated:this.putDataInHoverCallback("mouseOver"),onDeactivated:this.putDataInHoverCallback("mouseOut")}),height:390,domain:{x:this.props.range},domainPadding:{y:20}},i.a.createElement(O.a,{text:this.props.title,x:225,y:30,textAnchor:"middle",style:{fontFamily:"Times New Roman"}}),i.a.createElement(w.a,{scale:"time",tickCount:this.props.tickCount,tickFormat:this.props.xTickFn,tickValues:this.props.tickValues?this.tickValues(this.props.tickValues):this.props.tickValues,style:j}),i.a.createElement(w.a,{dependentAxis:!0,tickFormat:x,style:T}),i.a.createElement(w.a,{dependentAxis:!0,tickFormat:D,orientation:"right",style:_}),i.a.createElement(E.a,{x:"time",y:"temperature",interpolation:"linear",data:this.props.data,style:{data:{stroke:"#fc0"}}}),i.a.createElement(b.a,{data:this.props.data,x:"time",y:"temperature",size:this.sizeFn,style:{data:{fill:"#f00"}}}),i.a.createElement(E.a,{x:"time",y:"humidity",interpolation:"linear",data:this.props.data,style:{data:{stroke:"#0ff"}}}),i.a.createElement(b.a,{data:this.props.data,x:"time",y:"humidity",size:this.sizeFn,style:{data:{fill:"#0e5"}}}))}}]),e}(i.a.PureComponent),S=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],L=["Su","Mo","Tu","We","Th","Fr","Sa"],R=function(t){function e(){var t,a;Object(o.a)(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(u.a)(this,(t=Object(c.a)(e)).call.apply(t,[this].concat(i)))).timeOfDay=function(t){var e=new Date(t),a=e.getHours(),n=e.getMinutes();return"".concat(a,":").concat(n>9?n:"0"+n)},a.timeOfDayLong=function(t){var e=(new Date).getDay()===new Date(t).getDay();return a.timeOfDay(t)+(e?" Today":" Yesterday")},a.dayOfWeek=function(t){return S[new Date(t).getDay()]},a.dayOfWeekLong=function(t){return L[new Date(t).getDay()]+" "+a.timeOfDay(t)},a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return i.a.createElement("ol",{className:"charts"},i.a.createElement("li",null,i.a.createElement(F,{title:"Last 5 minutes",xTickFn:this.props.defaultXTickFn,mouseOver:this.props.mouseOver,mouseOut:this.props.mouseOut,data:this.props.last_5_minutes,isUpdate:this.props.isUpdate,tickValues:[5,4,3,2,1,0]})),i.a.createElement("li",null,i.a.createElement(F,{title:"This hour",xTickFn:this.props.defaultXTickFn,mouseOver:this.props.mouseOver,mouseOut:this.props.mouseOut,data:this.props.last_hour,tickValues:[50,30,10]})),i.a.createElement("li",null,i.a.createElement(F,{title:"Last 24 hours",xTickFn:this.timeOfDay,xTickFnLong:this.timeOfDayLong,mouseOver:this.props.mouseOver,mouseOut:this.props.mouseOut,data:this.props.today})),i.a.createElement("li",null,i.a.createElement(F,{title:"This week",xTickFn:this.dayOfWeek,xTickFnLong:this.dayOfWeekLong,mouseOver:this.props.mouseOver,mouseOut:this.props.mouseOut,data:this.props.last_week,range:[(new Date).getTime()-6048e5,(new Date).getTime()],tickCount:6})))}}]),e}(i.a.PureComponent),C=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(u.a)(this,Object(c.a)(e).call(this,t))).state={scrollY:window.pageYOffset,justUpdated:!1},a.handleScroll=function(){a.setState({scrollY:window.pageYOffset})},a.diff=function(t){if(!a.state.previous)return"";var e=Math.round(a.state.latest[t]),n=Math.round(a.state.previous[t]);return e===n?"\u2194\ufe0f":e>n?"\ud83d\udcc8":e<n?"\ud83d\udcc9":void 0},a.componentDidMount=function(){window.addEventListener("scroll",this.handleScroll)},a.componentWillUnmount=function(){window.removeEventListener("scroll",this.handleScroll)},a.wrapperRef=i.a.createRef(),a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"componentDidUpdate",value:function(){var t=this;this.state.justUpdated&&!this.justUpdatedTimeout&&(this.justUpdatedTimeout=setTimeout(function(){t.setState({justUpdated:!1},function(){t.justUpdatedTimeout=null})},1e3))}},{key:"className",value:function(t){var e=["big-number-wrapper"];return this.wrapperRef&&this.wrapperRef.current&&this.state.scrollY>this.wrapperRef.current.offsetTop&&e.push("fixed"),this.props.hover&&e.push("hover"),t.time||e.push("loading"),this.state.justUpdated&&e.push("just-updated"),e.join(" ")}},{key:"render",value:function(){var t=this.props.hover||this.props.latest;return i.a.createElement("div",{ref:this.wrapperRef,className:this.className(t)},t.time?i.a.createElement("dl",{className:"big-number"},i.a.createElement("dt",null,"Temperature "),i.a.createElement("dd",{className:"temperature"},Math.round(t.temperature),"\xb0 ",this.props.hover?"":this.diff("temperature")),i.a.createElement("dt",null,"Humidity"),i.a.createElement("dd",{className:"humidity"},Math.round(t.humidity),"% ",this.props.hover?"":this.diff("humidity")),i.a.createElement("dt",null,"Time"),i.a.createElement("dd",{className:"time"},t.timeString||"now")):"")}}],[{key:"getDerivedStateFromProps",value:function(t,e){var a=e.lastLatestTime&&t.latest.time&&e.lastLatestTime!==t.latest.time;return{justUpdated:a,previous:t.latest.time?a?e.latest:e.previous:null,latest:t.latest,lastLatestTime:t.latest.time}}}]),e}(i.a.PureComponent),U=a(133),N=a.n(U),A={latest:{},last_5_minutes:[],last_hour:[],today:[],last_week:[]},M=function(t){return 9*t/5+32},W=function(t){function e(){var t,a;Object(o.a)(this,e);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(u.a)(this,(t=Object(c.a)(e)).call.apply(t,[this].concat(i)))).state=Object(v.a)({},A),a.formatDatum=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{humidity:t[e+"humidity"],temperature:M(t[e+"temperature"]),time:new Date(t[a+"time"]).getTime()}},a.handleReceivedReading=function(t){var e=new Date-3e5,n=a.state.last_5_minutes.filter(function(t){return t.time>e}),i=a.formatDatum(t.historical_reading);a.setState({latest:i,last_5_minutes:Object(f.a)(n).concat([i]),isUpdate:!0})},a.xTick=function(t){return new Date-t<5e3?"now":N.a.ago(t,!1)+" ago"},a.mouseOver=function(t,e){var n=t.find(function(t){return t.temperature&&!t.continuous}),i=t.find(function(t){return t.humidity&&!t.continuous});n&&i&&a.setState({hover:{temperature:n.temperature,humidity:i.humidity,time:n.time,timeString:e(n.time)}})},a.mouseOut=function(t){a.setState(function(e){return!t[0]||e.hover&&e.hover.time===t[0].time?{hover:null}:{}})},a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){this.setReadings()}},{key:"componentDidUpdate",value:function(){this.props.location.slug!==this.state.locationSlug&&this.setReadings()}},{key:"setReadings",value:function(){var t,e,a=this,n=this.props.location.slug;this.setState(Object(v.a)({},A,{locationSlug:n})),t=n,e=function(t){a.setState({latest:a.formatDatum(t.latest),last_5_minutes:a.data(t.last_5_minutes),last_hour:a.data(t.last_hour,"mean_","start_"),today:a.data(t.today,"mean_","start_"),last_week:a.data(t.last_week,"mean_","start_"),locationSlug:n,isUpdate:!1})},fetch("".concat(d,"/locations/").concat(t,"/readings")).then(function(t){return t.json()}).then(e)}},{key:"data",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t.map(function(t){return e.formatDatum(t,a,n)})}},{key:"render",value:function(){var t=this.props.location;return i.a.createElement("section",null,i.a.createElement("h2",null,this.props.location.name),i.a.createElement(C,{hover:this.state.hover,latest:this.state.latest,xTick:this.xTick}),i.a.createElement(y.ActionCable,{key:t.slug,channel:{channel:"ReadingsChannel",location:t.slug},onReceived:this.handleReceivedReading}),this.state.last_5_minutes.length?i.a.createElement(R,{mouseOver:this.mouseOver,mouseOut:this.mouseOut,last_5_minutes:this.state.last_5_minutes,last_hour:this.state.last_hour,today:this.state.today,last_week:this.state.last_week,isUpdate:this.state.isUpdate,defaultXTickFn:this.xTick}):"")}}]),e}(n.Component),V=function(t){var e=t.locations.map(function(t){return i.a.createElement("li",{key:t.slug},i.a.createElement(h.a,{to:"/"+t.slug},t.name))});return i.a.createElement("ol",{className:"locations"},e)},P=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("marquee",null,"Welcome to SwampCast 2000!!!"),i.a.createElement("p",null,"Select a location from the menu ^^"))},Y=function(t){function e(){var t,a;Object(o.a)(this,e);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(t=Object(c.a)(e)).call.apply(t,[this].concat(r)))).state={locations:[]},a.renderLocation=function(t){var e=t.match.params.locationSlug,n=a.state.locations.find(function(t){return t.slug===e});return n?i.a.createElement(W,{location:n}):i.a.createElement(i.a.Fragment,null)},a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t,e=this;t=function(t){e.setState({locations:t})},fetch("".concat(d,"/locations")).then(function(t){return t.json()}).then(t)}},{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(V,{locations:this.state.locations}),i.a.createElement("h1",{className:"header-main"},i.a.createElement(h.a,{to:"/"},"SwampCast 2000")),i.a.createElement("hr",{className:"graph-divider-top"}),i.a.createElement(p.a,{exact:!0,path:"/",component:P}),i.a.createElement(p.a,{path:"/:locationSlug",render:this.renderLocation}))}}]),e}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var z=a(273);s.a.render(i.a.createElement(y.ActionCableProvider,{url:"wss://tempapi-backend.herokuapp.com/cable"},i.a.createElement(z.a,null,i.a.createElement(Y,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[136,2,1]]]);
//# sourceMappingURL=main.6a6e6718.chunk.js.map